SELECT MAX(SALARY) FROM EMPLOYEES;

SELECT * FROM EMPLOYEES
WHERE SALARY=24000;

SELECT * FROM EMPLOYEES
WHERE SALARY= (SELECT MAX(SALARY) FROM EMPLOYEES);

SELECT * FROM EMPLOYEES
WHERE SALARY= (SELECT MIN(SALARY) FROM EMPLOYEES);

SELECT MAX(SALARY) FROM EMPLOYEES
WHERE SALARY < (SELECT MAX(SALARY) FROM EMPLOYEES);

SELECT * FROM EMPLOYEES
WHERE SALARY = (SELECT MAX(SALARY) FROM EMPLOYEES
                WHERE SALARY < (SELECT MAX(SALARY) FROM EMPLOYEES));



SELECT * FROM EMPLOYEES
WHERE SALARY > (SELECT AVG(SALARY) FROM EMPLOYEES);


--Select employee info with 5th highest salary
SELECT DISTINCT SALARY FROM EMPLOYEES
ORDER BY SALARY DESC;

SELECT MIN(SALARY) FROM (SELECT DISTINCT SALARY FROM EMPLOYEES
               ORDER BY SALARY DESC)
WHERE ROWNUM <6;

SELECT MIN(SALARY) FROM (SELECT * FROM (SELECT DISTINCT SALARY FROM EMPLOYEES
                                        ORDER BY SALARY DESC)
                         WHERE ROWNUM <6);

--Select info of employee with 5th highest salary
SELECT * from EMPLOYEES
WHERE SALARY = (SELECT MIN(SALARY) FROM (SELECT * FROM (SELECT DISTINCT SALARY FROM EMPLOYEES
                                                        ORDER BY SALARY DESC)
                                         WHERE ROWNUM <6));

--Select info of employee with 37th highest salary
SELECT * from EMPLOYEES
WHERE SALARY = (SELECT MIN(SALARY) FROM (SELECT * FROM (SELECT DISTINCT SALARY FROM EMPLOYEES
                                                        ORDER BY SALARY DESC)
                                         WHERE ROWNUM <38));

--Select info of employee with 5th highest salary (optomized)
SELECT * from EMPLOYEES
WHERE SALARY = (SELECT MIN(SALARY) FROM (SELECT DISTINCT SALARY FROM EMPLOYEES
                                         ORDER BY SALARY DESC)
                WHERE ROWNUM <6);

--3rd lowest
SELECT * from EMPLOYEES
WHERE SALARY = (SELECT MAX(SALARY) FROM (SELECT DISTINCT SALARY FROM EMPLOYEES
                                         ORDER BY SALARY ASC)
                WHERE ROWNUM <4);
